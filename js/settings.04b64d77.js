"use strict";(self["webpackChunkavwx_account"]=self["webpackChunkavwx_account"]||[]).push([[472],{9424:function(e,t,s){s.r(t),s.d(t,{default:function(){return pe}});var l=s(641);const a=(0,l.Lk)("h2",null,"Notifications",-1),r=(0,l.Lk)("p",null,"The AVWX mailing list will keep you updated on new features and API changes. You'll only get a couple each year, so don't worry about a full inbox.",-1),o=["disabled"],i=["disabled"];function n(e,t,s,n,u,d){const c=(0,l.g2)("Header"),m=(0,l.g2)("Profile"),b=(0,l.g2)("font-awesome-icon"),h=(0,l.g2)("DangerZone");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(c,{title:"Settings"}),(0,l.Lk)("main",null,[e.currentUser?((0,l.uX)(),(0,l.Wv)(m,{key:0,user:e.currentUser},null,8,["user"])):(0,l.Q3)("",!0),(0,l.Lk)("section",null,[a,r,e.currentUser?.subscribed?((0,l.uX)(),(0,l.CE)("button",{key:0,onClick:t[0]||(t[0]=t=>e.mailing(!1)),disabled:e.isSubmitting,class:"btn btn-primary"},[(0,l.bF)(b,{icon:["far","envelope-open"]}),(0,l.eW)(" Unsubscribe ")],8,o)):((0,l.uX)(),(0,l.CE)("button",{key:1,onClick:t[1]||(t[1]=t=>e.mailing(!0)),disabled:e.isSubmitting,class:"btn btn-primary"},[(0,l.bF)(b,{icon:["far","envelope"]}),(0,l.eW)(" Subscribe ")],8,i))]),e.currentUser?((0,l.uX)(),(0,l.Wv)(h,{key:1})):(0,l.Q3)("",!0)])])}var u=s(1114),d=s(1635),c=s(8490);const m=(0,l.Lk)("h2",{class:"title-danger"},"Danger Zone",-1),b={class:"btn btn-danger",type:"button","data-bs-toggle":"modal","data-bs-target":"#deleteUserModal"};function h(e,t,s,a,r,o){const i=(0,l.g2)("DeleteUserModal"),n=(0,l.g2)("font-awesome-icon");return(0,l.uX)(),(0,l.CE)("section",null,[(0,l.bF)(i,{onDelete:t[0]||(t[0]=t=>e.deleteUser())}),m,(0,l.Lk)("button",b,[(0,l.bF)(n,{icon:"trash"}),(0,l.eW)(" Delete Account")])])}s(4114);var p=s(3464),g=s(3751);const f={class:"modal fade",id:"deleteUserModal",tabindex:"-1","aria-labelledby":"deleteModalLabel","aria-hidden":"true"},k={class:"modal-dialog"},v={class:"modal-content"},y=(0,l.Lk)("div",{class:"modal-header"},[(0,l.Lk)("h5",{class:"modal-title",id:"deleteModalLabel"},"Delete Your Account?"),(0,l.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),A={class:"modal-body"},L=(0,l.Lk)("p",null,"You're about to delete your account. This action will delete all user info and cannot be reversed.",-1),_=(0,l.Lk)("p",null,"Type your email to confirm deletion.",-1),S={class:"modal-footer"},C=(0,l.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1),x=["disabled"];function E(e,t,s,a,r,o){return(0,l.uX)(),(0,l.CE)("div",f,[(0,l.Lk)("div",k,[(0,l.Lk)("div",v,[y,(0,l.Lk)("div",A,[L,_,(0,l.Lk)("p",null,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.email=t),placeholder:"email"},null,512),[[g.Jo,e.email]])])]),(0,l.Lk)("div",S,[C,(0,l.Lk)("button",{onClick:t[1]||(t[1]=t=>e.$emit("delete")),disabled:e.isDisabled,type:"button",class:"btn btn-danger"},"Delete",8,x)])])])])}var U=s(71);let F=class extends c.lD{constructor(...e){super(...e),(0,u.A)(this,"email",""),(0,u.A)(this,"userStore",(0,U.k)())}get isDisabled(){return this.userStore.user?.email!=this.email}};F=(0,d.Cg)([(0,c.uA)({emits:["delete"]})],F);var w=(0,c.t$)(F),D=s(6262);const X=(0,D.A)(w,[["render",E]]);var V=X,M=s(1606),P=s(1424);let T=class extends c.lD{constructor(...e){super(...e),(0,u.A)(this,"toast",(0,p.useToast)()),(0,u.A)(this,"authStore",(0,P.n)()),(0,u.A)(this,"userStore",(0,U.k)())}hideDeleteModal(){const e=document.getElementById("deleteUserModal");e&&e.remove();for(const t of document.getElementsByClassName("modal-backdrop"))t.remove()}deleteUser(){M.A.deleteUser().then((()=>{Promise.all([this.authStore.logout(),this.userStore.clear()]).then((()=>{this.hideDeleteModal(),this.toast.success("Account deleted"),this.$router.push("/")}))}),(e=>{console.log(e)}))}};T=(0,d.Cg)([(0,c.uA)({components:{DeleteUserModal:V}})],T);var $=(0,c.t$)(T);const H=(0,D.A)($,[["render",h]]);var W=H,N=s(6205),Y=s(33);const B=(0,l.Lk)("h2",null,"Contact Information",-1),I={key:1};function Q(e,t,s,a,r,o){const i=(0,l.g2)("ProfileEdit"),n=(0,l.g2)("font-awesome-icon");return(0,l.uX)(),(0,l.CE)("section",null,[B,e.showProfileEdit?((0,l.uX)(),(0,l.Wv)(i,{key:0,user:e.updateFields,onClose:t[0]||(t[0]=t=>e.showProfileEdit=!1)},null,8,["user"])):((0,l.uX)(),(0,l.CE)("div",I,[(0,l.Lk)("p",null,"Email: "+(0,Y.v_)(e.user.email||""),1),(0,l.Lk)("p",null,"First: "+(0,Y.v_)(e.user.first_name||""),1),(0,l.Lk)("p",null,"Last: "+(0,Y.v_)(e.user.last_name||""),1),(0,l.Lk)("button",{onClick:t[1]||(t[1]=t=>e.showProfileEdit=!0),class:"btn btn-primary"},[(0,l.bF)(n,{icon:"edit"}),(0,l.eW)(" Edit ")])]))])}const Z={class:"form-group"},q=(0,l.Lk)("label",{for:"email"},"Email",-1),j={class:"form-group"},J=(0,l.Lk)("label",{for:"first_name"},"First Name",-1),K={class:"form-group"},z=(0,l.Lk)("label",{for:"last_name"},"Last Name",-1),G={key:0,class:"form-group"},O={class:"form-group"},R=["disabled"];function ee(e,t,s,a,r,o){const i=(0,l.g2)("Field"),n=(0,l.g2)("ErrorMessage"),u=(0,l.g2)("Form");return(0,l.uX)(),(0,l.Wv)(u,{onSubmit:e.updateUser,"validation-schema":e.schema},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Z,[q,(0,l.bF)(i,{modelValue:e.user.email,"onUpdate:modelValue":t[0]||(t[0]=t=>e.user.email=t),name:"email",type:"text",id:"email",class:"form-control","aria-describedby":"emailHelp",placeholder:"high@flier.io"},null,8,["modelValue"]),(0,l.bF)(n,{name:"email",id:"emailHelp",class:"form-text text-muted"})]),(0,l.Lk)("div",j,[J,(0,l.bF)(i,{modelValue:e.user.first_name,"onUpdate:modelValue":t[1]||(t[1]=t=>e.user.first_name=t),name:"first_name",type:"text",id:"first_name",class:"form-control","aria-describedby":"first_nameHelp",placeholder:"High"},null,8,["modelValue"]),(0,l.bF)(n,{name:"first_name",id:"first_nameHelp",class:"form-text text-muted"})]),(0,l.Lk)("div",K,[z,(0,l.bF)(i,{modelValue:e.user.last_name,"onUpdate:modelValue":t[2]||(t[2]=t=>e.user.last_name=t),name:"last_name",type:"text",id:"last_name",class:"form-control","aria-describedby":"last_nameHelp",placeholder:"Flier"},null,8,["modelValue"]),(0,l.bF)(n,{name:"last_name",id:"first_nameHelp",class:"form-text text-muted"})]),e.errorText.length>0?((0,l.uX)(),(0,l.CE)("div",G,[(0,l.Lk)("p",null,(0,Y.v_)(e.errorText),1)])):(0,l.Q3)("",!0),(0,l.Lk)("div",O,[(0,l.Lk)("button",{type:"submit",name:"action",disabled:e.isSubmitting,class:"btn btn-primary"},"Update",8,R),(0,l.Lk)("button",{onClick:t[3]||(t[3]=(...t)=>e.cancel&&e.cancel(...t)),class:"btn btn-primary"},"Back")])])),_:1},8,["onSubmit","validation-schema"])}var te=s(5261),se=s(1250),le=s(2664);let ae=class extends c.lD{constructor(...e){super(...e),(0,u.A)(this,"user",void 0),(0,u.A)(this,"errorText",""),(0,u.A)(this,"isSubmitting",!1),(0,u.A)(this,"toast",(0,p.useToast)()),(0,u.A)(this,"authStore",(0,P.n)()),(0,u.A)(this,"userStore",(0,U.k)()),(0,u.A)(this,"schema",le.object().shape({email:le.string().email("Not a valid email").required("Email is required"),first_name:le.string(),last_name:le.string()}))}updateUser(e){this.isSubmitting=!0;const t=this.userStore.user?.email.slice();this.userStore.updateUser(e).then((()=>{e.email!=t?Promise.all([this.authStore.logout(),this.userStore.clear()]).then((()=>{this.toast.success("Successfully updated your email. You'll need to log back in to continue"),this.$router.push("/")})):this.$emit("close")}),(e=>{if(this.isSubmitting=!1,console.log(e),!se.A.isAxiosError(e))throw this.errorText="An unknown error occurred",e;console.log(e.response?.data),this.errorText=e.response?.data?.detail||"An unknown server error occurred"}))}cancel(){this.$emit("close")}};(0,d.Cg)([c.kv],ae.prototype,"user",void 0),ae=(0,d.Cg)([(0,c.uA)({components:{Form:te.lV,Field:te.D0,ErrorMessage:te.Kw},emits:["close"]})],ae);var re=(0,c.t$)(ae);const oe=(0,D.A)(re,[["render",ee]]);var ie=oe;let ne=class extends c.lD{constructor(...e){super(...e),(0,u.A)(this,"user",void 0),(0,u.A)(this,"showProfileEdit",!1)}get updateFields(){return{email:this.user.email,first_name:this.user.first_name,last_name:this.user.last_name}}};(0,d.Cg)([c.kv],ne.prototype,"user",void 0),ne=(0,d.Cg)([(0,c.uA)({components:{ProfileEdit:ie}})],ne);var ue=(0,c.t$)(ne);const de=(0,D.A)(ue,[["render",Q]]);var ce=de;let me=class extends c.lD{constructor(...e){super(...e),(0,u.A)(this,"isSubmitting",!1),(0,u.A)(this,"userStore",(0,U.k)())}get currentUser(){return this.userStore.user}mailing(e){this.isSubmitting=!0,M.A.mailing(e).then((()=>this.userStore.getUser().then((()=>this.isSubmitting=!1))))}};me=(0,d.Cg)([(0,c.uA)({components:{DangerZone:W,Header:N.A,Profile:ce}})],me);var be=(0,c.t$)(me);const he=(0,D.A)(be,[["render",n]]);var pe=he}}]);
//# sourceMappingURL=settings.04b64d77.js.map