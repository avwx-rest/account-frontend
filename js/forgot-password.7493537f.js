"use strict";(self["webpackChunkavwx_account"]=self["webpackChunkavwx_account"]||[]).push([[100],{7145:function(e,t,s){s.d(t,{A:function(){return g}});var r=s(641),n=s(33);function o(e,t,s,o,a,i){const l=(0,r.g2)("font-awesome-icon");return(0,r.uX)(),(0,r.CE)("div",{class:(0,n.C4)(["alert","alert-"+e.type]),role:"alert"},[(0,r.bF)(l,{icon:e.icon},null,8,["icon"]),(0,r.eW)("Â "+(0,n.v_)(e.text),1)],2)}var a=s(1114),i=s(1635),l=s(8490);const c={info:"info-circle",success:"check-circle",warning:"exclamation-triangle",danger:"times-circle"};let u=class extends l.lD{constructor(...e){super(...e),(0,a.A)(this,"type",void 0),(0,a.A)(this,"text",void 0)}get icon(){return c[this.type]||"bell"}};(0,i.Cg)([l.kv],u.prototype,"type",void 0),(0,i.Cg)([l.kv],u.prototype,"text",void 0),u=(0,i.Cg)([l.uA],u);var m=(0,l.t$)(u),d=s(6262);const h=(0,d.A)(m,[["render",o]]);var g=h},4429:function(e,t,s){s.r(t),s.d(t,{default:function(){return V}});var r=s(641);const n={key:0},o=(0,r.Lk)("h1",null,"Forgot Password",-1),a={key:1},i=(0,r.Lk)("h1",null,"Reset Password",-1);function l(e,t,s,l,c,u){const m=(0,r.g2)("ForgotPasswordForm"),d=(0,r.g2)("ResetPasswordForm");return 0==e.token.length?((0,r.uX)(),(0,r.CE)("div",n,[o,(0,r.bF)(m)])):((0,r.uX)(),(0,r.CE)("div",a,[i,(0,r.bF)(d,{token:e.token},null,8,["token"])]))}var c=s(1114),u=(s(4114),s(1635)),m=s(8490);const d={class:"form-group"},h=(0,r.Lk)("label",{for:"email"},"Email",-1),g={key:0,class:"form-group"},p={class:"form-group"},f=["disabled"];function b(e,t,s,n,o,a){const i=(0,r.g2)("Field"),l=(0,r.g2)("ErrorMessage"),c=(0,r.g2)("Alert"),u=(0,r.g2)("Form");return(0,r.uX)(),(0,r.Wv)(u,{onSubmit:e.handleForm,"validation-schema":e.schema},{default:(0,r.k6)((()=>[(0,r.Lk)("div",d,[h,(0,r.bF)(i,{name:"email",type:"email",id:"email",class:"form-control","aria-describedby":"emailHelp",placeholder:"Enter email"}),(0,r.bF)(l,{name:"email",id:"emailHelp",class:"form-text text-muted"})]),e.errorText.length>0?((0,r.uX)(),(0,r.CE)("div",g,[(0,r.bF)(c,{type:"danger",text:e.errorText},null,8,["text"])])):(0,r.Q3)("",!0),(0,r.Lk)("div",p,[(0,r.Lk)("button",{type:"submit",name:"action",disabled:e.isSubmitting,class:"btn btn-primary"},"Send Reset Email",8,f)])])),_:1},8,["onSubmit","validation-schema"])}var v=s(5261),w=s(3464),x=s(1250),k=s(2664),A=s(7145),F=s(6720);let y=class extends m.lD{constructor(...e){super(...e),(0,c.A)(this,"errorText",""),(0,c.A)(this,"isSubmitting",!1),(0,c.A)(this,"schema",k.object().shape({email:k.string().email("Not a valid email").required("Email is required")})),(0,c.A)(this,"toast",(0,w.useToast)())}handleForm(e){this.isSubmitting=!0,F.A.forgotPassword(e.email).then((()=>{this.toast.success("Password reset email is on the way"),this.$router.push("/")}),(e=>{if(this.isSubmitting=!1,console.log(e),!x.A.isAxiosError(e))throw this.errorText="An unknown error occurred",e;console.log(e.response?.data),this.errorText=e.response?.data?.detail||"An unknown server error occurred"}))}};y=(0,u.Cg)([(0,m.uA)({components:{Alert:A.A,Form:v.lV,Field:v.D0,ErrorMessage:v.Kw}})],y);var $=(0,m.t$)(y),S=s(6262);const C=(0,S.A)($,[["render",b]]);var E=C,L=s(33);const P={class:"form-group"},M=(0,r.Lk)("label",{for:"password"},"New Password",-1),T={class:"form-group"},R=(0,r.Lk)("label",{for:"confirm"},"Confirm Password",-1),X={key:0,class:"form-group"},q={class:"form-group"},D=["disabled"];function H(e,t,s,n,o,a){const i=(0,r.g2)("Field"),l=(0,r.g2)("ErrorMessage"),c=(0,r.g2)("Form");return(0,r.uX)(),(0,r.Wv)(c,{onSubmit:e.handleForm,"validation-schema":e.schema},{default:(0,r.k6)((()=>[(0,r.Lk)("div",P,[M,(0,r.bF)(i,{name:"password",type:"password",id:"password",class:"form-control","aria-describedby":"passwordHelp",placeholder:"Password"}),(0,r.bF)(l,{name:"password",id:"passwordHelp",class:"form-text text-muted"})]),(0,r.Lk)("div",T,[R,(0,r.bF)(i,{name:"confirm",type:"password",id:"confirm",class:"form-control","aria-describedby":"confirmHelp",placeholder:"Confirm password"}),(0,r.bF)(l,{name:"confirm",id:"confirmHelp",class:"form-text text-muted"})]),e.errorText.length>0?((0,r.uX)(),(0,r.CE)("div",X,[(0,r.Lk)("p",null,(0,L.v_)(e.errorText),1)])):(0,r.Q3)("",!0),(0,r.Lk)("div",q,[(0,r.Lk)("button",{type:"submit",name:"action",disabled:e.isSubmitting,class:"btn btn-primary"},"Reset Password",8,D)])])),_:1},8,["onSubmit","validation-schema"])}var _=s(8701),N=s.n(_);N()(k);let W=class extends m.lD{constructor(...e){super(...e),(0,c.A)(this,"token",void 0),(0,c.A)(this,"errorText",""),(0,c.A)(this,"isSubmitting",!1),(0,c.A)(this,"schema",k.object().shape({password:k.string().required("Password is required"),confirm:k.string().oneOf([k.ref("password"),void 0],"Passwords must match")})),(0,c.A)(this,"toast",(0,w.useToast)())}handleForm(e){this.isSubmitting=!0,F.A.resetPassword(this.token,e.password).then((()=>{this.toast.success("Password has been reset. Log in to continue"),this.$router.push("/login")}),(e=>{if(this.isSubmitting=!1,console.log(e),!x.A.isAxiosError(e))throw this.errorText="An unknown error occurred",e;console.log(e.response?.data),this.errorText=e.response?.data?.detail||"An unknown server error occurred"}))}};(0,u.Cg)([m.kv],W.prototype,"token",void 0),W=(0,u.Cg)([(0,m.uA)({components:{Alert:A.A,Form:v.lV,Field:v.D0,ErrorMessage:v.Kw}})],W);var z=(0,m.t$)(W);const I=(0,S.A)(z,[["render",H]]);var U=I,Z=s(1424);let j=class extends m.lD{constructor(...e){super(...e),(0,c.A)(this,"token",""),(0,c.A)(this,"authStore",(0,Z.n)())}mounted(){this.token=this.$route.query.t||""}created(){this.loggedIn&&this.$router.push("/")}get loggedIn(){return this.authStore.loggedIn}};j=(0,u.Cg)([(0,m.uA)({components:{ForgotPasswordForm:E,ResetPasswordForm:U}})],j);var K=(0,m.t$)(j);const Q=(0,S.A)(K,[["render",l]]);var V=Q},8701:function(e){const t=function(e,t){return 1===t?e:`${e}s`},s=function(e){return null===e||void 0===e};function r(e=1,r){const n=r||"${path} must contain at least ${length} lowercase "+t("letter",e);return this.test({name:"minLowercase",exclusive:!0,message:n,params:{length:e},test(t){return s(t)||(t.match(/[a-z]/g)||[]).length>=e}})}function n(e=1,r){const n=r||"${path} must contain at least ${length} uppercase "+t("letter",e);return this.test({name:"minUppercase",exclusive:!0,message:n,params:{length:e},test(t){return s(t)||(t.match(/[A-Z]/g)||[]).length>=e}})}function o(e=1,r){const n=r||"${path} must contain at least ${length} "+t("number",e);return this.test({name:"minNumber",exclusive:!0,message:n,params:{length:e},test(t){return s(t)||(t.match(/[0-9]/g)||[]).length>=e}})}function a(e=1,r){const n=r||"${path} must contain at least ${length} "+t("symbol",e);return this.test({name:"minSymbol",exclusive:!0,message:n,params:{length:e},test(t){return s(t)||(t.match(/[^a-zA-Z0-9\s]/g)||[]).length>=e}})}function i(e=2,r){const n=r||"${path} must not contain sequences of more than ${length} repeated "+t("character",e);return this.test({name:"maxRepeating",exclusive:!0,message:n,params:{length:e},test(t){return s(t)||!new RegExp(`(.)\\1{${e},}`).test(t)}})}function l(e=2,r){const n=r||"${path} must contain at least ${length} "+t("word",e),o=new RegExp("[a-zA-Z0-9]");return this.test({name:"minWords",exclusive:!0,message:n,params:{length:e},test(t){return s(t)||t.split(" ").filter((e=>!!e&&o.test(e))).length>=e}})}function c(){return this.min(8).max(250).minLowercase(1).minUppercase(1).minNumbers(1).minSymbols(1)}function u(e){e.addMethod(e.string,"minLowercase",r),e.addMethod(e.string,"minUppercase",n),e.addMethod(e.string,"minNumbers",o),e.addMethod(e.string,"minSymbols",a),e.addMethod(e.string,"minRepeating",i),e.addMethod(e.string,"maxRepeating",i),e.addMethod(e.string,"minWords",l),e.addMethod(e.string,"password",c)}e.exports=u}}]);
//# sourceMappingURL=forgot-password.7493537f.js.map